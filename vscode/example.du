// Duso Script Language Example
// This file demonstrates all syntax highlighting features

// ========================================
// Variables and Types
// ========================================
x = 5
name = "Alice"
flag = true
empty = nil

// ========================================
// Objects and Arrays
// ========================================
colors = ["red", "green", "blue"]
config = {timeout: 30, retries: 3}

// Access elements
first_color = colors[0]
timeout_val = config.timeout

// ========================================
// String Features
// ========================================

// Regular strings with templates
age = 30
msg = "Hello {{name}}, you are {{age}} years old"
sum_msg = "Result={{5 + 10}}"

// Multiline strings (triple quotes)
prompt = """
You are a helpful assistant.
Please respond in JSON format.
Be concise and accurate.
"""

// Multiline with templates
title = "Report"
doc = """
Title={{title}}

This is a multiline document.
It supports {{1 + 1}} expressions.
"""

// ========================================
// Functions and Closures
// ========================================
function add(x, y)
  return x + y
end

function greet(name)
  msg = "Hello {{name}}!"
  return msg
end

// Function with control flow
function process(data)
  if data then
    result = add(10, 20)
    return result
  else
    return nil
  end
end

// ========================================
// Variable Scoping with var Keyword
// ========================================

// var creates a local variable (shadows outer scope)
function testScoping()
  var localVar = 100  // var creates a truly local variable
  globalVar = 200     // without var, modifies/creates in outer scope
end

globalVar = 10
testScoping()
print(globalVar)      // Prints 200 (was modified)

// ========================================
// Closures
// ========================================

// Closures capture and modify variables from outer scope
function makeCounter()
  var count = 0
  function increment()
    count = count + 1  // Modifies captured count
    return count
  end
  return increment
end

counter = makeCounter()
print(counter())  // 1
print(counter())  // 2
print(counter())  // 3

function makeAdder(n)
  function add(x)
    return x + n
  end
  return add
end

addFive = makeAdder(5)
print(addFive(10))  // Output: 15

// ========================================
// Control Flow
// ========================================

// If/elseif/else
if x > 10 then
  print("big")
elseif x > 5 then
  print("medium")
else
  print("small")
end

// While loop
counter = 0
while counter < 5 do
  print(counter)
  counter = counter + 1
end

// Numeric for loop
for i = 1, 5 do
  print(i)
end

// Iterator for loop
for item in colors do
  print(item)
end

// ========================================
// Operators
// ========================================

// Arithmetic
result = 5 + 3
result = 10 - 2
result = 4 * 5
result = 20 / 4
result = 10 % 3

// Comparison
if x == 5 then print("equal") end
if x != 5 then print("not equal") end
if x < 10 then print("less") end
if x > 3 then print("greater") end

// Logical
if true and false then print("both") end
if true or false then print("one") end
if not false then print("inverted") end

// ========================================
// Exception Handling
// ========================================
try
  risky = process(data)
  print(risky)
catch (error)
  print("Error=" + error)
end

// ========================================
// Built-in Functions
// ========================================

// String functions
upper_text = upper("hello")
lower_text = lower("WORLD")
parts = split("a,b,c", ",")
joined = join(["one", "two"], "-")

// String search and replace
if contains("hello world", "world") then
  modified = replace("hello world", "world", "duso")
end

// Type functions
array_len = len(colors)
string_len = len("hello")
t = type(42)

// Array functions
append(colors, "yellow")
sorted = sort([3, 1, 4, 1, 5])

// Math functions
rounded = round(3.7)
absolute = abs(-42)
minimum = min(5, 2, 8)
maximum = max(5, 2, 8)
